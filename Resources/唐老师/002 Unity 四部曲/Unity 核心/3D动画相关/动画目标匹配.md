---
tags:
  - 科学/Unity/唐老狮/Unity核心/3D动画相关/动画目标匹配
created: 2024-03-30
课时: "85"
---

---
# 关联知识点



---
# 知识点

## 什么是动画目标匹配

- 动画目标匹配主要指的是
- 当游戏中角色要以某种动作移动，该动作播放完毕后，人物的手或者脚必须落在某一个地方
	- 比如：角色需要跳过踏脚石或者跳跃并抓住房梁
- 那么这时我们就需要动作目标匹配来达到想要的效果
## 如何实现动画目标匹配

- Unity 中的 Animator 提供了对应的函数来完成该功能
### 使用步骤是

- 找到动作关键点位置信息
	- 比如起跳点，落地点，简单理解就是真正可能产生位移的动画表现部分
	- 通过创建一个空物体，传入空物体的位置
- 将关键信息传入 MatchTargetAPI 中
## 注意

- 调用匹配动画的时机有一些限制
	- 必须保证动画已经切换到了目标动画上
		- 即 不在动画过渡时间 内
	- 必须保证调用时动画并不是处于过度阶段而真正在播放目标动画
	- **如果发现匹配不正确，往往都是这两个原因造成的
- 需要开启 Apply Root Motion
### 解决方法

- 通过在动画中添加[[代码控制动画|动画事件]]进行处理
## API

- `animator.MatchTarget(targetPos.position, targetPos.rotation, AvatarTarget.RightFoot, new MatchTargetWeightMask(Vector3.one, 1), 0.4f, 0.64f);
### 参数

- 参数一
	- 目标位置
- 参数二
	- 目标角度
- 参数三
	- 匹配的骨骼位置
- 参数四
	- 位置角度权重
- 参数五
	- 开始位移动作的百分比
	- 根据动画中[[预览窗口]]查看
- 参数六
	- 结束位移动作的百分比
	- 根据动画中[[预览窗口]]查看

---
# 源代码

![[动画目标匹配 知识点.cs]]

---
