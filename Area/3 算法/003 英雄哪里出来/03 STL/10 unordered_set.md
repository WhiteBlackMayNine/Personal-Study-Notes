---
tags:
  - "#Cpp"
  - "#STL"
created: 2025-04-28
---

---
# 关联知识点

[[11 unordered_map]]

---
# 基础概念

无序集合
底层原理使用哈希表实现
集合元素无法重复，且每次打印都是无序的

一般情况下，使用这个容器就是不在乎元素的顺序的

> 时间复杂度：数组 $O(n)$ 二叉树 $O（\log n）$ 哈希表 $O(1)$

==散列容器==

但是：`unordered_multiset` 内的元素可以重复
## 桶 ID

下标索引又叫 桶 ID
桶 ID 是用来索引到某个具体的桶的
因为用的取模，所以得到的 桶 ID 都是连续的自然数
这样桶可以用数组来实现
## 哈希冲突

哈希冲突，是指两个元素的键不同，但是它们计算得到的桶 ID 相同的情况

常见的哈希冲突解决方案，是一个桶 (bucket) 中盛放多个元素
这样就可以通过哈希算法快速找到桶，再通过遍历桶中所有元素，实现快速查找
## STL 中的哈希表

STL 中，数据并不是存储在 bucket 这一个桶中，而是利用了 (bucket<<1）和 (bucket<<1)+1 两个位置
并且把所有桶中元素串联成一个链表，它里面的元素，是从 (bucket<<1）的位置作为链表起点，(bucket<<1)+1 作为链表终点，
来存储哈希表中的所有桶 ID，做为 bucket 的结点

所有的哈希表结点会被链接到一个全局的双向链表中，双向链表有个虚拟头结点 `_Head`
当 bucket 中没有任何元素的时候，那么在 bucket<<1和 (bucket<<1)+1 位置上的值正好是 `_Head`
## 元素插入

当桶中没有任何元素，那么 (bucket<<1）和 (bucket<<1)+1 两个位置 存储的就是 全局双向链表的虚拟头结点
当插入一个元素（如 1314）时，这两个位置都变成 1314 这个结点，同时每个结点都会 `_Head` 进行链接
于是 1314 就变成了，只有数据结点和虚拟头结点的双向链表（其实两个 1314 的地址是一样的，虚拟头结点的地址也是一样的）
再插入一个 520，会从后往前遍历链表，如果没有找到一个元素就会将其插入到头部，然后对每个元素进行链接
然后再插入一个 886，也是从后往前遍历，没有找到将其插入头部，然后对每个元素进行连接

注意，这里的 1314、520、886，都是哈希冲突后执行的插入操作，它们的桶 ID 一致，才会插入到一个链表中
## 元素查找

从双向链表的尾部开始，往前遍历，如果找到键相等的则返回
如果找不到则会返回一个全局双向链表的头结点
## 元素删除

找到桶 ID，逆序遍历双向链表进行查找，找到对应的结点进行删除
# 对象创建

```C++
//默认构造函数  
unordered_set<int> unorderedSet1;  
  
//初始化列表  
unordered_set<int> unorderedSet2 = {95, 7, 8, 9, 65, 4};  
unordered_set<int> unorderedSet2_2({95, 7, 8, 9, 65, 4, 5});  
  
//迭代器  
unordered_set<int> unorderedSet3(unorderedSet2.begin(), unorderedSet2.end());  
  
//构造函数  
unordered_set<int> unorderedSet4(unorderedSet2);
```
# 赋值操作

打印出来，两个对象的打印结果是不同的

```C++
//= 对象
unordered_set<int> u1 = {8,9,8,5,6};
unordered_set<int> u;
u = u1;

//初始化列表
u = {8,96,5,1};
```
# 大小操作

```C++
empty()//判空
size()//获取大小
```
# 数据插入

```C++
//元素仍是无序的
u.insert(10);

//迭代器
vector<int> v = { 1,2,3,52};
u.insert(v.begin(),v.end());
```
# 数据查找

```C++
//找到了返回迭代器 没找到返回 u.end()
auto it = u.find(5);
```
# 数据删除

```C++
u.erase(3);//删除一个值
u.erase(it);//删除迭代器
u.erase(it1,it2);//传入一个迭代器区间 但无序集合 不建议用 不知道删掉到底是什么
u.clear();//清空
```
# 数据统计

```C++
u.count(i);//某个元素的出现次数
```

---
