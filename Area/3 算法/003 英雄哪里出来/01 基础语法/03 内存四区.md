---
tags:
  - "#Cpp"
created: 2025-04-17
---

---
# 关联知识点

[[04 引用]]

---
# 代码区

所有写的代码都会放在代码区内 
最终都会转换成 01 的二进制数据

两个特点：只读、共享
# 全局区

存放 全局变量、常量、静态变量
# 栈区

==函数的参数存储在栈区==

由操作系统控制生命周期
与数据结果的栈 是两个东西

不要去返回局部变量的地址，当函数返回（也就是函数销毁时），局部变量被回收
如果返回的局部变量已经被赋值，那么可能造成内存错误

比如：
```C++
char* func(){
	char c[20] = "但是哦呜"
	return c;
}

int main(){
	cout << func;
}
```
程序运行时内存错误，因为此时 func 是一个野指针
字符串常量存储在全局区内，局部变量 `c` 存储在栈区
函数销毁时，局部变量也被销毁了，所以此时返回的 `c` 为一个 野指针
# 堆区

由程序员来控制生命周期 
与数据结果的堆 是两个东西

申请用 new 释放用 delete

```C++
int* getV(int v){
	int *a = new int(v);//注意 `int *a` 是一个栈上的变量
	cout << a;//`*a` 也就是 a 解引用以后得到的值，是存储在堆上面的
	return a;//函数返回的时候，虽然栈上的 a 被操作系统释放了
			//但是 a 指向的内存还是存在的 也就是 new int(v)
}

int main(){
	int *p = getV(3.14);
	cout << *p;
	return 0
}
```
# 内存申请释放

```C**
int *ptr = new int(1212);//申请
delete ptr;//释放
```
# 数组申请释放

```C**
int* getGapList(int *arr,int size){
	int *p = new int p[size - 1]; 
	//int a[size -1]; return a; a 为栈上内存，不能做为返回值返回，不可使用
	
	return p;
}
```


---
