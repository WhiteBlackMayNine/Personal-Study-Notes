---

excalidraw-plugin: parsed
tags: [excalidraw]

---
==⚠  Switch to EXCALIDRAW VIEW in the MORE OPTIONS menu of this document. ⚠== You can decompress Drawing data with the command palette: 'Decompress current Excalidraw file'. For more info check in plugin settings under 'Saving'


# Excalidraw Data

## Text Elements
Unity 编辑下，静态字段是不会被清除的
（单例模式、静态属性，尤其是不继承Mono的单例）
比如MVC中的Model（本次项目使用的） ^3hHHOT3l

所以，就需要手动的清除静态字段 ^aSCkFYd3

public class SingletonNoMono<T> where T : class, new() {
    private static T _instance;
    
    // 添加实例销毁标记
    private static bool _isDestroyed = false;

    public static T MainInstance {
        get {
            if (_isDestroyed) {
                _instance = null;
                _isDestroyed = false;
            }
            return _instance ??= new T();
        }
    }

    // 新增销毁方法
    public static void DestroyInstance() {
        _instance = null;
        _isDestroyed = true;
    }
} ^9i6CrLYj


using UnityEditor;


public class SingletonCleaner {
    // 游戏启动时自动执行
    [RuntimeInitializeOnLoadMethod(RuntimeInitializeLoadType.BeforeSceneLoad)]
    static void ResetSingletons() {
        BattleBackpackModel.DestroyInstance();
        // 可添加其他需要清理的单例...
    }

    // 编辑器退出播放模式时执行
    [InitializeOnPlayMode]
    static void OnPlayModeExit(PlayModeStateChange state) {
        if (state == PlayModeStateChange.ExitingPlayMode) {
            BattleBackpackModel.DestroyInstance();
        }
    }
} ^IflHrgVB

但是，在程序打包之后，每次重新启动游戏
静态字段都会被重置 ^rCYVy2iN

（说是什么 程序集 在Unity编辑时不会卸载） ^58XkNymd

%%
## Drawing
```compressed-json
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
```
%%