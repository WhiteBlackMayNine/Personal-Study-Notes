---

excalidraw-plugin: parsed
tags: [excalidraw]

---
==⚠  Switch to EXCALIDRAW VIEW in the MORE OPTIONS menu of this document. ⚠== You can decompress Drawing data with the command palette: 'Decompress current Excalidraw file'. For more info check in plugin settings under 'Saving'


# Excalidraw Data

## Text Elements
Unity 编辑下，静态字段是不会被清除的
（单例模式、静态属性，尤其是不继承Mono的单例）
比如MVC中的Model（本次项目使用的） ^3hHHOT3l

所以，就需要手动的清除静态字段 ^aSCkFYd3

public class SingletonNoMono<T> where T : class, new() {
    private static T _instance;
    
    // 添加实例销毁标记
    private static bool _isDestroyed = false;

    public static T MainInstance {
        get {
            if (_isDestroyed) {
                _instance = null;
                _isDestroyed = false;
            }
            return _instance ??= new T();
        }
    }

    // 新增销毁方法
    public static void DestroyInstance() {
        _instance = null;
        _isDestroyed = true;
    }
} ^9i6CrLYj

#if UNITY_EDITOR
using UnityEditor;
#endif

public class SingletonCleaner {
    // 游戏启动时自动执行
    [RuntimeInitializeOnLoadMethod(RuntimeInitializeLoadType.BeforeSceneLoad)]
    static void ResetSingletons() {
        BattleBackpackModel.DestroyInstance();
        // 可添加其他需要清理的单例...
    }

#if UNITY_EDITOR
    // 编辑器退出播放模式时执行
    [InitializeOnPlayMode]
    static void OnPlayModeExit(PlayModeStateChange state) {
        if (state == PlayModeStateChange.ExitingPlayMode) {
            BattleBackpackModel.DestroyInstance();
        }
    }
#endif
} ^IflHrgVB

但是，在程序打包之后，每次重新启动游戏
静态字段都会被重置 ^rCYVy2iN

（说是什么 程序集 在Unity编辑时不会卸载） ^58XkNymd

%%
## Drawing
```compressed-json
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
```
%%